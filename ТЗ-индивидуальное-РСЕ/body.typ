#import "data.typ": data

= ВВЕДЕНИЕ
== Наименование программы

Наименование программы -- "#data.project_name".\
Наименование программы на английском языке -- "#data.project_name_english".

== Краткая характеристика области применения программы

#data.brief_characteristic_area-application_program

= ОСНОВАНИЯ ДЛЯ РАЗРАБОТКИ
== Документ(ы), на основании которого(ых) ведется разработка

Разработка ведется на основании учебного плана подготовки бакалавров по направлению 09.03.04 "Программная инженерия" и утвержденной академическим руководителем программы темы курсового проекта.

== Наименование темы разработки

Наименование темы разработки -- "#data.project_name".\
Условное обозначение темы разработки -- "#data.project_name_english".\

= НАЗНАЧЕНИЕ РАЗРАБОТКИ
== Функциональное назначение

Серверная часть обеспечивает REST/JSON и потоковые API (SSE/Chunked) для каталога проектов, заявок, модерации и рекомендаций; аутентификацию через SSO edu.hse.ru; интеграцию с брокером очередей и ML-сервисом поиска/рекомендаций; импорт и нормализацию данных из внешних таблиц; экспорт в LMS/ЕЛК. Реализация — модульный монолит на Python (Django ASGI или FastAPI) с выделенным ML-гейтом.

== Эксплуатационное назначение

#data.operational_purpose


= ТРЕБОВАНИЯ К ПРОГРАММЕ
== Требования к функциональным характеристикам
=== Требования к составу выполняемых функций

API для студента:
1. Аутентификация через SSO edu.hse.ru, выдача сессионных токенов/JWT.
2. Получение каталога проектов с фильтрами по курсу, ОП, технологиям, типу, статусу комплектования; пагинация.
3. Семантический поиск и рекомендации (через ML-гейт), поддержка потоковой выдачи пояснений LLM.
4. Получение детальной карточки проекта, подача/отзыв заявки, отслеживание статуса.

API для заказчика:
1. CRUD карточек проектов, управление статусами (черновик, модерация, публикация), загрузка вложений.
2. Просмотр заявок студентов на свои проекты, принятие/отклонение с указанием причины.
3. Управление квотами мест и окнами набора.

API для администратора/ЦППРП:
1. Модерация проектов (возврат с комментарием ≥100 символов, публикация/отклонение).
2. Управление дедлайнами, шаблонами и параметрами импорта/экспорта.
3. Просмотр агрегированных показателей (проекты, заявки, утвержденные участники), выгрузки для LMS/ЕЛК.

Интеграции и фоновые задачи:
1. Импорт и парсинг проектов из Google/Yandex Sheets или загруженных XLSX, очистка и нормализация данных.
2. Публикация событий в брокер (Kafka/RabbitMQ/Redis Streams).
3. Вызовы ML-гейта для поиска/рекомендаций; обновление индекса после импорта и изменения данных.
4. Экспорт данных (проекты, заявки, статусы) в XLSX/CSV или API LMS/ЕЛК.

=== Требования к организации входных данных

1. Запросы пользователей (REST/JSON) с учётными данными SSO и токенами сессии/JWT.
2. Файлы таблиц (Google/Yandex Sheets, XLSX) для импорта проектов и структур курсов/ОП/тегов.
3. События из очереди (Kafka/RabbitMQ/Redis Streams) для актуализации индекса поиска/рекомендаций.
4. Запросы к ML-гейту и ответы от него (HTTP/gRPC), включая потоковые ответы LLM.

=== Требования к организации выходных данных

1. Ответы на API-запросы в формате JSON с кодами HTTP 2xx/4xx/5xx и детализированными ошибками.
2. SSE/Chunked-ответы для поиска и LLM-рекомендаций с явными типами событий и keep‑alive.
3. Логи (структурированные JSON) запросов, ошибок, модерационных действий; метрики для Prometheus.
4. Экспортные файлы XLSX/CSV по запросам ЦППРП/заказчиков.

=== Требования к временным характеристикам

1. Время обработки типовых запросов (каталог, заявка) — до 1 секунды при номинальной нагрузке.
2. Получение первых результатов семантического поиска — до 1 секунды; первый chunk LLM — до 2 секунд.
3. Актуализация индекса рекомендаций/поиска после изменения данных — до 5 минут в фоне.
4. Импорт пакета проектов (до 1600 записей) — в асинхронном режиме с уведомлением о статусе.

=== Требования к интерфейсу

Веб-интерфейс не реализуется; взаимодействие — через REST/JSON и потоковые API. Требуется OpenAPI-спецификация и JSON Schema для контрактов, единообразные коды ошибок, пагинация и фильтры в API. SSE/Chunked-ответы оформляются с явными типами событий и keep‑alive.

== Требования к надежности

1. Атомарность операций БД, транзакции при изменении связанных сущностей (проект/места/заявки).
2. Идемпотентность для повторных запросов и безопасные ретраи очередей; поддержка idempotency-key.
3. Кеширование частых запросов (каталог, фильтры, счетчики) в Redis; инвалидация по событиям.
4. Мониторинг (Prometheus/Grafana), централизованные логи, алерты по SLA (ошибки, задержки, очередь).
5. Репликация БД и регулярные бэкапы; тест восстановления.
6. Таймауты внешних вызовов (ML, импорт), Circuit Breaker/Retry с backoff.

== Условия эксплуатации
=== Климатические условия эксплуатации

Работа в стандартных условиях дата-центра или облачной инфраструктуры с резервированием питания и сети.

=== Требования к видам обслуживания

Мониторинг сервисов, обновления зависимостей, проверка бэкапов и восстановления, управление секретами. Реакция на инциденты по внутренним регламентам.

=== Требования к численности и квалификации персонала

Требуются специалисты уровня middle для сопровождения backend/БД/DevOps; инженер ML/инфраструктуры для поддержки ML-гейта и индекса.

== Требования к составу и параметрам технических средств
=== Программные средства

1. Python 3.12+ (рекомендуется LTS); допускается 3.14 после проверки совместимости зависимостей.
2. Веб-слой: Django 5+ (ASGI) или FastAPI; запуск через gunicorn с UvicornWorker.
3. БД: PostgreSQL 15+; миграции — Django migrations или Alembic.
4. Брокер: Kafka (предпочтительно); допускается RabbitMQ или Redis Streams.
5. Кеш: Redis.
6. Фоновые задачи: Celery/Arq/RQ с использованием выбранного брокера.
7. ML-гейт: отдельный сервис (FastAPI/Flask) для поиска/рекомендаций; индекс FAISS/pgvector; модели Qwen/YaGPT (по доступу).
8. Контейнеризация: Docker/Docker Compose; CI/CD — GitHub Actions; наблюдаемость — Prometheus/Grafana, Sentry или аналог.

=== Технические средства

1. Сервер приложений: ≥4 vCPU, 16-32 ГБ RAM, SSD ≥100 ГБ; масштабирование по горизонтали за балансировщиком.
2. Сервер БД: ≥4 vCPU, 16–32 ГБ RAM, отдельный SSD-том, реплика для чтения.
3. Брокер/кеш: выделенный узел Redis; Kafka/RabbitMQ — отдельные ноды по числу брокеров.
4. Сетевые требования: доступ к SSO edu.hse.ru, Sheets API, LMS/ЕЛК; HTTPS, предпочтительно HTTP/2.

== Требования к информационной и программной совместимости

=== Требования к информационным структурам и методам решения

1. Доменная сегрегация: схемы/неймспейсы БД по модулям (`users`, `projects`, `applications`, `ml`); запрет прямых межсхемных JOIN в коде.
2. Событийная модель: публикация `project_updated`, `student_interests_updated`, `application_status_changed` в брокер; ML-гейт обновляет индекс на их основе.
3. API-версирование и OpenAPI-спецификации; JSON Schema для валидации на входе/выходе.

=== Требования к программным средствам, используемым программой

1. Аутентификация через SSO edu.hse.ru (SAML/OAuth); поддержка JWT/куки, хранение сессий в Redis.
2. Интеграция с Google/Yandex Sheets API и парсинг XLSX.
3. Интеграция с LMS/ЕЛК для экспорта (API или файловые выгрузки).
4. ML-гейт и брокер событий (Kafka/RabbitMQ/Redis Streams), совместимые с выбранным стеком.

=== Требования к исходным кодам и языкам программирования

Языки: Python 3.12+ (допускается 3.14 после тестов совместимости).\
Фреймворки: Django 5+ (ASGI) или FastAPI; Celery/Arq/RQ для фоновых задач; ML-гейт — FastAPI/Flask.\
Библиотеки: Django ORM или SQLAlchemy/psycopg; pydantic/DRF serializers; aiokafka/pika/redis-py для брокера; redis-py; prometheus-client; structlog/loguru для логов.

=== Требования к защите информации и программы

1. HTTPS; хранение секретов в vault/переменных окружения; маскирование чувствительных данных в логах.
2. CSRF-защита, secure/HttpOnly/SameSite для куки; ограничение CORS по списку доменов.
3. Ролевая модель и проверка прав на уровне API; аудит действий (модерация, заявки, изменения проектов).
4. Ограничение размеров запросов/вложений; защита от SQLi/XSS/CSRF; проверка вложений по типу и размеру.

== Требования к маркировке и упаковке

1. Исходный код в репозитории с тегами релизов; артефакты (Docker-образы, миграции) маркируются версией и коммитом.
2. Поставочный пакет: docker-compose/helm-чарты, .env.example, инструкции по развертыванию, OpenAPI-спецификация.
3. Бэкапы БД/очередей маркируются датой/версией; контрольные суммы для архивов.

== Требования к транспортированию и хранению

Артефакты (образы, бэкапы, миграции) хранятся в приватном реестре и защищенном хранилище; транспортируются в зашифрованном виде (SCP/VPN).

== Специальные требования

Специальные требования отсутствуют. Соблюдать регламенты НИУ ВШЭ по защите персональных данных и эксплуатации облачных сервисов.


= ТРЕБОВАНИЯ К ПРОГРАММНОЙ ДОКУМЕНТАЦИИ
== Состав программной документации

1. "#data.project_name". Техническое задание (ГОСТ 19.201-78 [7]).
2. "#data.project_name". Пояснительная записка (ГОСТ 19.404-79 [10]).
3. "#data.project_name". Программа и методика испытаний (ГОСТ 19.301-79 [8]).
4. "#data.project_name". Текст программы (ГОСТ 19.401-78 [9]).
5. "#data.project_name". Руководство оператора (ГОСТ 19.505-79 [11]).

== Специальные требования к программной документации

Документы выполняются по ГОСТ 19.106-78 [6] и ГОСТам к каждому виду. Электронные версии — .pdf; исходный код и конфигурации — в архиве .zip с указанием версии; загрузка в LMS/SmartLMS согласно регламенту.


= ТЕХНИКО-ЭКОНОМИЧЕСКИЕ ПОКАЗАТЕЛИ
== Предполагаемая потребность

Пиковая потребность — осенний набор (~1700 студентов, ~1600 проектов). Система должна устойчиво обрабатывать массовые фильтрации/поиск/рекомендации и импорты таблиц.

== Целевая аудитория

ЦППРП, преподаватели/заказчики, студенты НИУ ВШЭ, внешние интеграции (LMS/ЕЛК).

== Преимущества перед аналогами

1. Автоматический импорт из Sheets/XLSX и нормализация данных.
2. Семантический поиск и LLM-рекомендации.
3. Событийная модель и интеграция с LMS/ЕЛК.

#let column_names = (
    [#data.analogue_1],
    [#data.analogue_2],
    [#data.analogue_3],
    [#data.project_name],
)

#let plus = table.cell(
  fill: green.lighten(60%),
)[+]

#let minus = table.cell(
  fill: red.lighten(60%),
)[-]

#figure(
    caption: [Сравнение функциональных характеристик аналогов],
    table(
        columns: (5cm,) + (auto,) * column_names.len(),
        rows: (2cm, 1.5cm),
        align: center + top,
        table.header(
            [Функции],
            ..column_names.map(col => rotate(0deg, reflow: true, col))
        ),

        [Импорт таблиц (Google/Yandex Sheets, XLSX)],   minus,  minus,  minus, plus,
        [Семантический поиск и LLM-рекомендации],       minus,  minus,  minus, plus,
        [Модерация проектов и дедлайны по ОП],          plus,   plus,   minus, plus,
        [Подача и отслеживание заявок студентов],       plus,   plus,   minus, plus,
        [Экспорт в LMS/ЕЛК и отчёты],                   minus,  plus,   minus, plus,

        [*Итого*], [*2*], [*3*], [*0*], [*5*],
    )
)


= СТАДИИ И ЭТАПЫ РАЗРАБОТКИ
== Стадии разработки, этапы и содержание работ

Стадии и этапы разработки определены с учетом ГОСТ 19.102-77 [2] и ограничений проекта (15 недель, январь–март 2026 г.).

#let column_names = (
    [*Стадия разработки*],
    [*Этап/минимум*],
    [*Содержание работ*],
    [*Сроки выполнения*],
)

Таблица 2 -- Стадии и этапы разработки

#figure(
    table(
        columns: (auto, auto, 9cm, auto),
        rows: (15mm, auto),
        
        align: center + top,
        table.header(..column_names),

        [Техническое задание], [Утверждение требований], [Сбор исходных данных, уточнение ролей, контрактов API, архитектуры (модульный монолит + ML-гейт + брокер)], [до 10.01.2026],
        [НИР], [Анализ данных], [Проработка схем БД, контуров безопасности, событийной модели, прототип OpenAPI], [до 20.01.2026],
        [Разработка], [Минимум 1], [Базовые сущности и CRUD (проекты, заявки, пользователи), аутентификация SSO/JWT, каталог с фильтрами, импорт таблиц (async)], [Январь 2026],
        [Разработка], [Минимум 2-3], [Модерация проектов, потоковый поиск/рекомендации через ML-гейт, очередь событий, экспорт XLSX/CSV/LMS, кеш Redis], [Февраль 2026],
        [Разработка], [Минимум 4], [Тюнинг производительности, отказоустойчивость, бэкапы, расширенные отчеты, финализация API/документации], [Март 2026],
        [Тестирование и приемка], [ПМИ], [Функциональные, интеграционные и нагрузочные испытания (API, очередь, ML-гейт), устранение замечаний, подготовка релиза], [до 31.03.2026],
    )
)


== Сроки разработки и исполнители

Плановая длительность — 15 недель (январь–март 2026). Исполнитель: С. Е. Растворов, студент группы БПИ236 ФКН НИУ ВШЭ.


= ПОРЯДОК КОНТРОЛЯ И ПРИЕМКИ

Контроль и приемка разработки осуществляются в соответствии с документом "Программа и методика испытаний" (ГОСТ 19.301–79 [8]).

== Виды испытаний

1. Функциональные тесты API по ролям (студент/заказчик/администратор).
2. Интеграционные тесты с брокером, ML-гейтом и импортом Sheets/XLSX.
3. Нагрузочные тесты каталога/поиска/рекомендаций и массовых заявок (locust/k6).
4. Тесты безопасности (аутентификация/авторизация, защита ПДн, ограничения по ролям).

== Общие требования к приемке работы

1. Выполнение функциональных и нефункциональных требований настоящего ТЗ.
2. Отсутствие критических дефектов по результатам ПМИ.
3. Наличие актуальной OpenAPI-спецификации, миграций БД, конфигураций запуска.
4. Подтверждение заказчиком/ЦППРП по приемочным сценариям.


#set heading(numbering: none)
= СПИСОК ИСПОЛЬЗУЕМОЙ ЛИТЕРАТУРЫ

1. ГОСТ 19.101-77: Виды программ и программных документов. \// Единая система программной документации. – М.: ИПК Издательство стандартов, 2001.
2. ГОСТ 19.102-77: Стадии разработки. \// Единая система программной документации. – М.: ИПК Издательство стандартов, 2001.
3. ГОСТ 19.103-77: Обозначения программ и программных документов. \// Единая система программной документации. – М.: ИПК Издательство стандартов, 2001.
4. ГОСТ 19.104-78: Основные надписи. \// Единая система программной документации. – М.: ИПК Издательство стандартов, 2001.
5. ГОСТ 19.105-78: Общие требования к программным документам. \// Единая система программной документации. – М.: ИПК Издательство стандартов, 2001.
6. ГОСТ 19.106-78: Требования к программным документам, выполненным печатным способом. \// Единая система программной документации. – М.: ИПК Издательство стандартов, 2001.
7. ГОСТ 19.201-78: Техническое задание. Требования к содержанию и оформлению. \// Единая система программной документации. – М.: ИПК Издательство стандартов, 2001.
8. ГОСТ 19.301-79: Программа и методика испытаний. Требования к содержанию и оформлению. \// Единая система программной документации. – М.: ИПК Издательство стандартов, 2001.
9. ГОСТ 19.401-78: Текст программы. Требования к содержанию и оформлению. \// Единая система программной документации. – М.: ИПК Издательство стандартов, 2001.
10. ГОСТ 19.404-79: Пояснительная записка. Требования к содержанию и оформлению. \// Единая система программной документации. – М.: ИПК Издательство стандартов, 2001.
11. ГОСТ 19.505-79: Руководство оператора. Требования к содержанию и оформлению. \// Единая система программной документации. – М.: ИПК Издательство стандартов, 2001.
12. ГОСТ 19.603-78: Общие правила внесения изменений. \// Единая система программной документации. – М.: ИПК Издательство стандартов, 2001.
13. ГОСТ 19.604-78: Правила внесения изменений в программные документы, выполненные печатным способом. \// Единая система программной документации. – М.: ИПК Издательство стандартов, 2001.
14. Документация по Django. URL: https://docs.djangoproject.com/
15. Документация по FastAPI. URL: https://fastapi.tiangolo.com/
16. Документация по PostgreSQL. URL: https://www.postgresql.org/docs/
17. Документация по Kafka. URL: https://kafka.apache.org/documentation/
18. Документация по Redis. URL: https://redis.io/docs/
19. Документация по Celery. URL: https://docs.celeryq.dev/
20. Документация по Prometheus. URL: https://prometheus.io/docs/introduction/overview/


= ПРИЛОЖЕНИЕ. ССЫЛКИ НА АНАЛОГИ

#figure(
  table(
    columns: (70mm, 70mm),
    rows: (10mm, auto),
    align: center + horizon,
    table.header([*Приложение*], [*Ссылка*]),

    [ИПС ФЭН], [https://fen.hse.ru],
    [Ярмарка ЭПП], [https://practices.hse.ru/],
    [Внутренние Excel/Forms], [https://forms.yandex.ru/],
  )
)

Дата обращения: 03.12.24.
